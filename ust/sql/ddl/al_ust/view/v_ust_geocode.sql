create or replace view "al_ust"."v_ust_geocode" as
 SELECT DISTINCT ust_old."FacilityID",
    ust_old."FacilityName",
    ust_old."OwnerType",
    ust_old."FacilityType1",
    ust_old."FacilityType2",
    ust_old."FacilityAddress1",
    ust_old."FacilityAddress2",
    ust_old."FacilityCity",
    ust_old."FacilityCounty",
    ust_old."FacilityZipCode",
    ust_old."FacilityPhoneNumber",
    ust_old."FacilityState",
    ust_old."FacilityEPARegion",
    ust_old."FacilityTribalSite",
    ust_old."FacilityTribe",
        CASE
            WHEN (ust_old.gc_latitude IS NOT NULL) THEN ust_old.gc_latitude
            ELSE ust_old."FacilityLatitude"
        END AS "FacilityLatitude",
        CASE
            WHEN (ust_old.gc_longitude IS NOT NULL) THEN ust_old.gc_longitude
            ELSE ust_old."FacilityLongitude"
        END AS "FacilityLongitude",
    ust_old.gc_coordinate_source,
    ust_old.gc_address_type,
    ust_old."FacilityCoordinateSource",
    ust_old."FacilityOwnerCompanyName",
    ust_old."FacilityOwnerLastName",
    ust_old."FacilityOwnerFirstName",
    ust_old."FacilityOwnerAddress1",
    ust_old."FacilityOwnerAddress2",
    ust_old."FacilityOwnerCity",
    ust_old."FacilityOwnerCounty",
    ust_old."FacilityOwnerZipCode",
    ust_old."FacilityOwnerState",
    ust_old."FacilityOwnerPhoneNumber",
    ust_old."FacilityOwnerEmail",
    ust_old."FacilityOperatorCompanyName",
    ust_old."FacilityOperatorLastName",
    ust_old."FacilityOperatorFirstName",
    ust_old."FacilityOperatorAddress1",
    ust_old."FacilityOperatorAddress2",
    ust_old."FacilityOperatorCity",
    ust_old."FacilityOperatorCounty",
    ust_old."FacilityOperatorZipCode",
    ust_old."FacilityOperatorState",
    ust_old."FacilityOperatorPhoneNumber",
    ust_old."FacilityOperatorEmail",
    ust_old."FinancialResponsibilityBondRatingTest",
    ust_old."FinancialResponsibilityCommercialInsurance",
    ust_old."FinancialResponsibilityGuarantee",
    ust_old."FinancialResponsibilityLetterOfCredit",
    ust_old."FinancialResponsibilityLocalGovernmentFinancialTest",
    ust_old."FinancialResponsibilityRiskRetentionGroup",
    ust_old."FinancialResponsibilitySelfInsuranceFinancialTest",
    ust_old."FinancialResponsibilityStateFund",
    ust_old."FinancialResponsibilitySuretyBond",
    ust_old."FinancialResponsibilityTrustFund",
    ust_old."FinancialResponsibilityOtherMethod",
    ust_old."FinancialResponsibilityNotRequired",
    ust_old."FinancialResponsibilityObtained",
    ust_old."Compliance",
    ust_old."TankID",
    ust_old."TankLocation",
    ust_old."FederallyRegulated",
    ust_old."TankStatus",
    ust_old."FieldConstructed",
    ust_old."EmergencyGenerator",
    ust_old."AirportHydrantSystem",
    ust_old."MultipleTanks",
    ust_old."ClosureDate",
    ust_old."InstallationDate",
    ust_old."CompartmentalizedUST",
    ust_old."NumberOfCompartments",
    ust_old."TankSubstanceStored",
    ust_old."CompartmentID",
    ust_old."CompartmentSubstanceStored",
    ust_old."TankCapacityGallons",
    ust_old."CompartmentCapacityGallons",
    ust_old."LinedTank",
    ust_old."ExcavationLiner",
    ust_old."TankWallType",
    ust_old."MaterialDescription",
    ust_old."TankRepaired",
    ust_old."TankRepairDate",
    ust_old."CertOfInstallation",
    ust_old."PipingMaterialDescription",
    ust_old."PipingFlexConnector",
    ust_old."PipingStyle",
    ust_old."PipingWallType",
    ust_old."PipingUDC",
    ust_old."PipingRepaired",
    ust_old."PipingRepairDate",
    ust_old."TankCorrosionProtectionSacrificialAnode",
    ust_old."TankCorrosionProtectionAnodeInstalledOrRetrofitted",
    ust_old."TankCorrosionProtectionImpressedCurrent",
    ust_old."TankCorrosionProtectionImpressedCurrentInstalledOrRetrofitted",
    ust_old."TankCorrosionProtectionCathodicNotRequired",
    ust_old."TankCorrosionProtectionInteriorLining",
    ust_old."TankCorrosionProtectionOther",
    ust_old."TankCorrosionProtectionUnknown",
    ust_old."TankCorrosionProtectionLinedPostinstallation",
    ust_old."PipingCorrosionProtectionSacrificialAnode",
    ust_old."PipingCorrosionProtectionAnodeInstalledOrRetrofitted",
    ust_old."PipingCorrosionProtectionImpressedCurrent",
    ust_old."PipingCorrosionProtectionImpressedCurrentInstalledOrRetrofitted",
    ust_old."PipingCorrosionProtectionCathodicNotRequired",
    ust_old."PipingCorrosionProtectionExternalCoating",
    ust_old."PipingCorrosionProtectionOther",
    ust_old."PipingCorrosionProtectionUnknown",
    ust_old."BallFloatValve",
    ust_old."FlowShutoffDevice",
    ust_old."HighLevelAlarm",
    ust_old."OverfillProtectionPrimary",
    ust_old."OverfillProtectionSecondary",
    ust_old."PrimaryOverfillInstallDate",
    ust_old."SecondaryOverfillInstallDate",
    ust_old."SpillBucketInstalled",
    ust_old."SpillBucketWallType",
    ust_old."DrainPresent",
    ust_old."PumpPresent",
    ust_old."InterstitialMonitoringContinualElectric",
    ust_old."InterstitialMonitoringManual",
    ust_old."AutomaticTankGauging",
    ust_old."AutomaticTankGaugingReleaseDetection",
    ust_old."AutomaticTankGaugingContinuousLeakDetection",
    ust_old."ManualTankGauging",
    ust_old."StatisticalInventoryReconciliation",
    ust_old."TankTightnessTesting",
    ust_old."GroundwaterMonitoring",
    ust_old."SubpartK",
    ust_old."VaporMonitoring",
    ust_old."ElectronicLineLeak",
    ust_old."MechanicalLineLeak",
    ust_old."AutomatedIntersticialMonitoring",
    ust_old."SafeSuction",
    ust_old."AmericanSuction",
    ust_old."PipingSubpartK",
    ust_old."HighPressure",
    ust_old."PrimaryReleaseDetectionType",
    ust_old."SecondReleaseDetectionType",
    ust_old."PipeSecondaryContainment",
    ust_old."PipeInstallDate",
    ust_old."USTReportedRelease",
    ust_old."AssociatedLUSTID",
    ust_old."LastInspectionDate"
   FROM archive.ust_old
  WHERE (((ust_old.state)::text = 'AL'::text) AND (ust_old.control_id = ( SELECT max(ust_control.control_id) AS max
           FROM archive.ust_control
          WHERE ((ust_control.organization_id)::text = 'AL'::text))));