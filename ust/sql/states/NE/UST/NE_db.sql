select * from tanks;

select * from facilities;

select distinct "Tank Corrosion Prot" from tanks order by 1;
null

select distinct "Tank Int Prot" from tanks order by 1;
COATED-RUST RESIST.
Double walled
DOUBLE WALLED
Internal Lining(e.g., epoxy resins)
Internal Lining(e.g., epoxy resins), UPGRADE 97
Internal Lining(e.g., epoxy resins), UPGRADE 98
None
None, Unknown
Unknown
Unknown, UPGRADE 98

select distinct "Tank Ext Prot" from tanks order by 1;
1' TAR
coated tar wrapped w/felt
Double walled
Double Walled
DOUBLE WALLED
Double walled / Polyethylene Tank Jacket
Fiberglass Reinforced Plastic Coated
Fiberglass Reinforced Plastic Coated, Galvanic/Sacrificial Current Cathodic Protection
Fiberglass Reinforced Plastic Coated, Galvanic/Sacrificial Current Cathodic Protection, Impressed Current Cathodic Protection
Fiberglass Reinforced Plastic Coated, Impressed Current Cathodic Protection
Fiberglass Reinforced Plastic Coated, Painted(e.g., asphaltic)
Fiberglass Reinforced Plastic Coated, STIP3
Fiberglass Reinforced Plastic Coated, STIP3 Tank
Fiberglass/Epoxy Resin Clad
Galvanic/Sacrificial Current Cathodic Protection
Galvanic/Sacrificial Current Cathodic Protection, Impressed Current Cathodic Protection
Galvanic/Sacrificial Current Cathodic Protection, Impressed Current Cathodic Protection, Painted(e.g., asphaltic)
Galvanic/Sacrificial Current Cathodic Protection, Impressed Current Cathodic Protection, Painted(e.g., asphaltic), STIP 3
Galvanic/Sacrificial Current Cathodic Protection, Impressed Current Cathodic Protection, STIP3
Galvanic/Sacrificial Current Cathodic Protection, Impressed Current Cathodic Protection, STIP3 Tank
Galvanic/Sacrificial Current Cathodic Protection, Impressed Current Cathodic Protection, URATHANE COAT
Galvanic/Sacrificial Current Cathodic Protection, Painted(e.g., asphaltic)
Galvanic/Sacrificial Current Cathodic Protection, Painted(e.g., asphaltic), Split compartment
Galvanic/Sacrificial Current Cathodic Protection, Painted(e.g., asphaltic), STIP3 Tank
Galvanic/Sacrificial Current Cathodic Protection, STIP3
Galvanic/Sacrificial Current Cathodic Protection, STIP3 Tank
Galvanic/Sacrificial Current Cathodic Protection, STIP3, STIP3 Tank
IMPRESSED CURRENT 97, Impressed Current Cathodic Protection, Painted(e.g., asphaltic)
Impressed Current Cathodic Protection
Impressed Current Cathodic Protection, Impressed current installed August 2011, Painted(e.g., asphaltic)
Impressed Current Cathodic Protection, Impressed Current installed August 2011, Painted(e.g., asphaltic)
Impressed Current Cathodic Protection, Painted(e.g., asphaltic)
Impressed Current Cathodic Protection, Painted(e.g., asphaltic), STIP3 Tank
Impressed Current Cathodic Protection, STIP3 Tank
IMPRESSED CURRENT, Impressed Current Cathodic Protection
None
None, Painted(e.g., asphaltic), TARRED
Painted(e.g., asphaltic)
Painted(e.g., asphaltic), SEE ABOVE
Painted(e.g., asphaltic), STIP3 Tank
Painted(e.g., asphaltic), TAR & POLYETHLYENE
Painted(e.g., asphaltic), TAR COATED
Painted(e.g., asphaltic), TARRED
Painted(e.g., asphaltic), Unknown 
Plastic jacket
Plastic Jacket
Plastic Jacketed
Poly Jacket
SAND, Unknown
Secondary HDPE Jacket
STIP3 Tank
TAR
TAR COATING
TAR COVERING
TARRED
UNDER CONCRETE FLOOR
Unknown
Vinyl Jacket

select distinct "Tank Sec Contain" from tanks order by 1;
360 Excavation Liner
360 Excavation Liner, Double Walled
Double Walled

select distinct "Piping Const. Material" from tanks order by 1;
Aboveground
And APT Flex, Fiberglass Reinforced Plastic
And APT Flex, Fiberglass Reinforced Plastic, Plastic
APT
APT Flex pipe
APT, Fiberglass Reinforced Plastic
APT, Fiberglass Reinforced Plastic, Plastic
APT, Plastic
APT, Plastic, Steel
Black pipe coated w/tar & wrapped
booted flex, Fiberglass Reinforced Plastic
Booted Scotchcoat
coated steel - booted, Fiberglass Reinforced Plastic
Coated Steel, Steel
coated, Steel
Copper
COPPER IN CHASE
Copper, Fiberglass Reinforced Plastic
Copper, Fiberglass Reinforced Plastic, Steel
Copper, Steel
CP'd steel to boiler/APT PermaFlex to generator, Plastic, Steel
double wall flex, Fiberglass Reinforced Plastic
double wall flexible pipe, Plastic
double wall flexible piping, Plastic
double walled
Double walled
DOUBLE WALLED
double walled supply line, Fiberglass Reinforced Plastic
double walled, Fiberglass Reinforced Plastic
Double walled, Fiberglass Reinforced Plastic
Double Walled, Fiberglass Reinforced Plastic
DOUBLE WALLED, Fiberglass Reinforced Plastic
double walled, Fiberglass Reinforced Plastic, Plastic
Double walled, Fiberglass Reinforced Plastic, Plastic
Double Walled, Fiberglass Reinforced Plastic, Plastic
DOUBLE WALLED, Fiberglass Reinforced Plastic, Plastic
DOUBLE WALLED, Fiberglass Reinforced Plastic, Steel
double walled, Plastic
Double walled, Plastic
Double Walled, Plastic
DOUBLE WALLED, Plastic
Double walled, Plastic, Fiberglass Reinforced Plastic
Double walled, Plastic, Steel
Douible Walled, Fiberglass Reinforced Plastic
Dual FRP x Steel
DW FLEX ADDED 2012, Fiberglass Reinforced Plastic, Plastic
Environ DW Hose
Existing pipe add on, Fiberglass Reinforced Plastic, Plastic
Fiberglass Reinforced Plastic
Fiberglass Reinforced Plastic, Fiberglass Reinforced Plastic
Fiberglass Reinforced Plastic, FLEX
Fiberglass Reinforced Plastic, Flex connector, Steel
Fiberglass Reinforced Plastic, FRP - vents / Plastic - product, Plastic
Fiberglass Reinforced Plastic, GALVANIZED STEEL
Fiberglass Reinforced Plastic, Plastic
Fiberglass Reinforced Plastic, Plastic, Fiberglass Reinforced Plastic
Fiberglass Reinforced Plastic, Plastic, Section replaced with flex plastic in 2011
Fiberglass Reinforced Plastic, Plastic, Siphon lines are FRP / double walled
Fiberglass Reinforced Plastic, Plastic, Two kinds of piping is correct
Fiberglass Reinforced Plastic, plus APT Flex
Fiberglass Reinforced Plastic, Steel
Flex Pipe, Plastic
Flexible - double walled, Plastic
Flexible, Plastic
galvanized steel
GALVANIZED STEEL
galvanized, Steel
Oil drain line
OPW-Flex, Plastic
OPW double wall flex works pipe, Plastic
OPW FLEX, Plastic
OPW Pices, Plastic, Plastic
Pipe under building is copper, Steel
Plastic
plastic composite - double wall
Plastic, Fiberglass Reinforced Plastic
Plastic, Plastic
Plastic, plastic composite - double wall
Plastic, Steel
Plastic, STEEL TO GENERATOR
Plastic, Total Containment Omni Flex Dbl Wall
PVC
PVC - DOUBLE WALLED
scotch coat
scotch kote, Steel
scotchcoat
Scotchkote
Scotchkote, Steel
Skotchkote
Steel
Steel Coated
Steel encased in FRP, Unknown
Steel Isolated
Steel, steel isolated from soil
Unknown
UPP


select * from information_schema.columns where table_name = 'tanks';

alter table tanks rename column "ï»¿Facility ID" to "Facility ID";
alter table facilities rename column "ï»¿Facility ID" to "Facility ID";

select * from information_schema.columns a where table_name = 'facilities' and not exists
	(select 1 from information_schema.columns b where a.column_name = b.column_name and b.table_name = 'tanks');
Owner St.
Curr in Use
Temp Out Use
Perm Out Use
Closed In Place
Tanks Removed

select count(*) from substance_lookup;

create table substance_lookup (tank_contents varchar(255), epa_substance varchar(255));
insert into substance_lookup values ('#1 Diesel','Diesel fuel (b-unknown)');
insert into substance_lookup values ('#1 Diesel, #2 Diesel','Diesel fuel (b-unknown)');
insert into substance_lookup values ('#1 Diesel, Other->clear','Diesel fuel (b-unknown)');
insert into substance_lookup values ('#1 Diesel, Other->dyed','Off-road diesel/dyed diesel');
insert into substance_lookup values ('#1 Diesel, Other->DYED','Off-road diesel/dyed diesel');
insert into substance_lookup values ('#1 Diesel, Other->dyed diesel','Off-road diesel/dyed diesel');
insert into substance_lookup values ('#1 Diesel, Other->Dyed diesel','Off-road diesel/dyed diesel');
insert into substance_lookup values ('#1 Diesel, Other->DYED DIESEL','Off-road diesel/dyed diesel');
insert into substance_lookup values ('#1 Diesel, Other->OFF ROAD','Off-road diesel/dyed diesel');
insert into substance_lookup values ('#1 Diesel, Other->RED DYED','Off-road diesel/dyed diesel');
insert into substance_lookup values ('#1 Diesel, Regular Unleaded','Diesel fuel (b-unknown)');
insert into substance_lookup values ('#1 Diesel, Unknown','Diesel fuel (b-unknown)');
insert into substance_lookup values ('#2 Diesel','Diesel fuel (b-unknown)');
insert into substance_lookup values ('#2 Diesel, E-85',' E-85/Flex Fuel (E51-E83)');
insert into substance_lookup values ('#2 Diesel, E-95','95% renewable diesel, 5% biodiesel');
insert into substance_lookup values ('#2 Diesel, Empty','Diesel fuel (b-unknown)');
insert into substance_lookup values ('#2 Diesel, Heating Oil 6','Diesel fuel (b-unknown)');
insert into substance_lookup values ('#2 Diesel, Other->#2 Dyed Diesel','Diesel fuel (b-unknown)');
insert into substance_lookup values ('#2 Diesel, Other->15% BIODIESEL','Diesel blends containing greater than 5% and up to 20% or less biodiesel');
insert into substance_lookup values ('#2 Diesel, Other->clear','Diesel fuel (b-unknown)');
insert into substance_lookup values ('#2 Diesel, Other->Clear','Diesel fuel (b-unknown)');
insert into substance_lookup values ('#2 Diesel, Other->dyed','Diesel fuel (b-unknown)');
insert into substance_lookup values ('#2 Diesel, Other->Dyed','Diesel fuel (b-unknown)');
insert into substance_lookup values ('#2 Diesel, Other->DYED','Diesel fuel (b-unknown)');
insert into substance_lookup values ('#2 Diesel, Other->dyed diesel','Off-road diesel/dyed diesel');
insert into substance_lookup values ('#2 Diesel, Other->Dyed diesel','Off-road diesel/dyed diesel');
insert into substance_lookup values ('#2 Diesel, Other->Dyed Diesel','Off-road diesel/dyed diesel');
insert into substance_lookup values ('#2 Diesel, Other->DYED DIESEL','Off-road diesel/dyed diesel');
insert into substance_lookup values ('#2 Diesel, Other->Dyed red','Off-road diesel/dyed diesel');
insert into substance_lookup values ('#2 Diesel, Other->field master','Diesel fuel (b-unknown)');
insert into substance_lookup values ('#2 Diesel, Other->HALF SAND FILLED 1987','Diesel fuel (b-unknown)');
insert into substance_lookup values ('#2 Diesel, Other->OFF ROAD','Off-road diesel/dyed diesel');
insert into substance_lookup values ('#2 Diesel, Other->RED','Off-road diesel/dyed diesel');
insert into substance_lookup values ('#2 Diesel, Other->roadmaster','Diesel fuel (b-unknown)');
insert into substance_lookup values ('#2 Diesel, Other->Roadmaster','Diesel fuel (b-unknown)');
insert into substance_lookup values ('#2 Diesel, Other->Roadmaster diesel','Diesel fuel (b-unknown)');
insert into substance_lookup values ('#2 Diesel, Other->Roadmaster Diesel','Diesel fuel (b-unknown)');
insert into substance_lookup values ('#2 Diesel, Other->RUBY CLEAR','Diesel fuel (b-unknown)');
insert into substance_lookup values ('#2 Diesel, Other->RUBY DYED','Off-road diesel/dyed diesel');
insert into substance_lookup values ('#2 Diesel, Other->Ruby Roadmaster','Diesel fuel (b-unknown)');
insert into substance_lookup values ('#2 Diesel, Other->with ethanol','Diesel fuel (b-unknown)');
insert into substance_lookup values ('#2 Diesel, Regular Unleaded','Diesel fuel (b-unknown)');
insert into substance_lookup values (', Hazard->107-12-1, Other->Ethylene glycol (Antifreeze)','Antifreeze');
insert into substance_lookup values (', Hazard->1330-20-7, Other->Xylene (LUBRIZOL 9888)','Solvent');
insert into substance_lookup values (', Hazard->1330-20-7, Other->Xylene (Ultrazol 9888)','Solvent');
insert into substance_lookup values (', Hazard->7681-52-9, Other->Sodium Hypochlorite','Other');
insert into substance_lookup values (', Hazard->Ethylhexyl Nitrate 27247-96-7, Other->OTR 8332G','Other');
insert into substance_lookup values (', Hazard->Sodium Hypochlorite','Other');
insert into substance_lookup values (', Hazard->Xylene 1330-20-7, Other->Ultrazol 9888','Solvent');
insert into substance_lookup values (', Other->#2 Dyed Diesel','Diesel fuel (b-unknown)');
insert into substance_lookup values (', Other->504 DIESEL','Diesel fuel (b-unknown)');
insert into substance_lookup values (', Other->AFTRON OTR 8332G','Diesel fuel (b-unknown)');
insert into substance_lookup values (', Other->AV Gas','Aviation gasoline');
insert into substance_lookup values (', Other->B-11','Diesel blends containing greater than 5% and up to 20% or less biodiesel');
insert into substance_lookup values (', Other->B-2','Diesel fuel (ASTM D975), can contain 0-5% biodiesel');
insert into substance_lookup values (', Other->B-20','Diesel blends containing greater than 5% and up to 20% or less biodiesel');
insert into substance_lookup values (', Other->B-99','Diesel blend containing 99% to less than 100% biodiesel');
insert into substance_lookup values (', Other->B-99 (Diesel Soy Oil)','Diesel blend containing 99% to less than 100% biodiesel');
insert into substance_lookup values (', Other->Clear diesel','Diesel fuel (b-unknown)');
insert into substance_lookup values (', Other->CLEAR SOY DIESEL','Diesel blend containing 99% to less than 100% biodiesel');
insert into substance_lookup values (', Other->DEF','Diesel exhaust fluid (DEF, not federally regulated)');
insert into substance_lookup values (', Other->Dyed diesel','Off-road diesel/dyed diesel');
insert into substance_lookup values (', Other->Dyed Diesel','Off-road diesel/dyed diesel');
insert into substance_lookup values (', Other->DYED DIESEL','Off-road diesel/dyed diesel');
insert into substance_lookup values (', Other->DYED SOY DIESEL','Off-road diesel/dyed diesel');
insert into substance_lookup values (', Other->E-0','Gasoline (non-ethanol)');
insert into substance_lookup values (', Other->E-100','Other');
insert into substance_lookup values (', Other->E-15','Gasoline E-15 (E-11-E15)');
insert into substance_lookup values (', Other->E-98','Other');
insert into substance_lookup values (', Other->E-99','Other');
insert into substance_lookup values (', Other->Hextane','Solvent');
insert into substance_lookup values (', Other->Jet A','Jet fuel A');
insert into substance_lookup values (', Other->JET A','Jet fuel A');
insert into substance_lookup values (', Other->MINERAL OIL','Other');
insert into substance_lookup values (', Other->OFF ROAD DIESEL','Off-road diesel/dyed diesel');
insert into substance_lookup values (', Other->SOY OIL','Other');
insert into substance_lookup values (', Other->ULTIMATE UNLEADED','Gasoline (unknown type)');
insert into substance_lookup values (', Other->V grade','Gasoline (unknown type)');
insert into substance_lookup values ('B-100','100% biodiesel (not federally regulated)');
insert into substance_lookup values ('B-100, Other->B-99','100% biodiesel (not federally regulated)');
insert into substance_lookup values ('B-5','Diesel fuel (ASTM D975), can contain 0-5% biodiesel');
insert into substance_lookup values ('E-10','Gasoline E-10 (E1-E10)');
insert into substance_lookup values ('E-10, Other->Super Unleaded','Gasoline E-10 (E1-E10)');
insert into substance_lookup values ('E-15','Gasoline E-15 (E-11-E15)');
insert into substance_lookup values ('E-85',' E-85/Flex Fuel (E51-E83)');
insert into substance_lookup values ('E-85, Mixed',' E-85/Flex Fuel (E51-E83)');
insert into substance_lookup values ('E-85, Other->87% ethanol',' E-85/Flex Fuel (E51-E83)');
insert into substance_lookup values ('E-85, Other->89% ethanol',' E-85/Flex Fuel (E51-E83)');
insert into substance_lookup values ('E-87','Gasoline/ethanol blend containing more than 83% and less than 98% ethanol');
insert into substance_lookup values ('E-89','Gasoline/ethanol blend containing more than 83% and less than 98% ethanol');
insert into substance_lookup values ('E-95','Gasoline/ethanol blend containing more than 83% and less than 98% ethanol');
insert into substance_lookup values ('E-98','Ethanol blend gasoline (e-unknown)');
insert into substance_lookup values ('E-99','Ethanol blend gasoline (e-unknown)');
insert into substance_lookup values ('Empty','');
insert into substance_lookup values ('Empty, Heating Oil 1','Heating oil/fuel oil 1');
insert into substance_lookup values ('Empty, Heating Oil 2','Heating oil/fuel oil 2');
insert into substance_lookup values ('Empty, Kerosene','Kerosene');
insert into substance_lookup values ('Empty, Mixed','Other');
insert into substance_lookup values ('Empty, Mixed, Regular Unleaded','Other');
insert into substance_lookup values ('Empty, Other->TRANSFORMER OIL','Other');
insert into substance_lookup values ('Empty, Regular Unleaded','Gasoline (unknown type)');
insert into substance_lookup values ('Empty, Used Oil','Used oil/waste oil');
insert into substance_lookup values ('Hazard->108-88-3, Other->TOLULENE','Solvent');
insert into substance_lookup values ('Hazard->64742-49-0, Other->HEXANE/Naptha','Solvent');
insert into substance_lookup values ('Hazard->64742-89-8, Other->TOLU-SOL ''A''''','Solvent');
insert into substance_lookup values ('Heating Oil 1','Heating oil/fuel oil 1');
insert into substance_lookup values ('Heating Oil 2','Heating oil/fuel oil 2');
insert into substance_lookup values ('Heating Oil 5','Heating oil/fuel oil 5');
insert into substance_lookup values ('Heating Oil 6','Heating/fuel oil # unknown');
insert into substance_lookup values ('Kerosene','Kerosene');
insert into substance_lookup values ('Kerosene, Other->WATER','Kerosene');
insert into substance_lookup values ('Mixed','Other');
insert into substance_lookup values ('Mixed, Other->HALF SAND FILLED 1987','Other');
insert into substance_lookup values ('Mixed, Regular Unleaded','Gasoline (unknown type)');
insert into substance_lookup values ('Mixed, Used Oil','Used oil/waste oil');
insert into substance_lookup values ('New Oil','Other');
insert into substance_lookup values ('Other-># 2 Dyed Diesel','Off-road diesel/dyed diesel');
insert into substance_lookup values ('Other->#1 Dyed Diesel','Off-road diesel/dyed diesel');
insert into substance_lookup values ('Other->#2 Dyed diesel','Off-road diesel/dyed diesel');
insert into substance_lookup values ('Other->#2 Dyed Diesel','Off-road diesel/dyed diesel');
insert into substance_lookup values ('Other->#2 Dyed Soy Diesel','Off-road diesel/dyed diesel');
insert into substance_lookup values ('Other->15% BIODIESEL, Regular Unleaded','Other unlisted blend containing any other mixture of diesel, renewable diesel, or 20% biodiesel or less');
insert into substance_lookup values ('Other->AROMATIC 100 SOLVENT','Solvent');
insert into substance_lookup values ('Other->AV Gas','Aviation gasoline');
insert into substance_lookup values ('Other->AvGas','Aviation gasoline');
insert into substance_lookup values ('Other->Aviation Fuel','Unknown aviation gas or jet fuel');
insert into substance_lookup values ('Other->Aviation Fuel - 100LL','Unknown aviation gas or jet fuel');
insert into substance_lookup values ('Other->Aviation Fuel - Jet A','Unknown aviation gas or jet fuel');
insert into substance_lookup values ('Other->Aviation Fuel, Regular Unleaded','Aviation gasoline');
insert into substance_lookup values ('Other->Aviation Gas','Aviation gasoline');
insert into substance_lookup values ('Other->B-99','Diesel blend containing 99% to less than 100% biodiesel');
insert into substance_lookup values ('Other->Biodiesel B-35','Diesel blend containing greater than 20% and less than 99% biodiesel');
insert into substance_lookup values ('Other->Boat Gas','Marine fuel');
insert into substance_lookup values ('Other->Boat Mix, Regular Unleaded','Marine fuel');
insert into substance_lookup values ('Other->BULK OIL','Other');
insert into substance_lookup values ('Other->BUTANE','Other');
insert into substance_lookup values ('Other->CLEANING SOLV. AMSCO 140','Solvent');
insert into substance_lookup values ('Other->Clear Soy Diesel','Biofuel/bioheat');
insert into substance_lookup values ('Other->CLOSED, Regular Unleaded','Gasoline (unknown type)');
insert into substance_lookup values ('Other->DEF','Diesel exhaust fluid (DEF, not federally regulated)');
insert into substance_lookup values ('Other->Denatured Alcohol','Solvent');
insert into substance_lookup values ('Other->Diesel Fuel Waste','Diesel exhaust fluid (DEF, not federally regulated)');
insert into substance_lookup values ('Other->dyed diesel','Off-road diesel/dyed diesel');
insert into substance_lookup values ('Other->Dyed Soy Diesel','Off-road diesel/dyed diesel');
insert into substance_lookup values ('Other->E-100','Gasoline (unknown type)');
insert into substance_lookup values ('Other->E-100, Regular Unleaded','Gasoline (unknown type)');
insert into substance_lookup values ('Other->E-15, Regular Unleaded','Gasoline E-15 (E-11-E15)');
insert into substance_lookup values ('Other->E-24, Regular Unleaded','Gasoline/ethanol blends E16-E50');
insert into substance_lookup values ('Other->E-40','Gasoline/ethanol blends E16-E50');
insert into substance_lookup values ('Other->E-98','Ethanol blend gasoline (e-unknown)');
insert into substance_lookup values ('Other->Fuel Oil','Other');
insert into substance_lookup values ('Other->HALF SAND FILLED 1987, Regular Unleaded','Other');
insert into substance_lookup values ('Other->High Sulphur','Other');
insert into substance_lookup values ('Other->Jet A','Jet fuel A');
insert into substance_lookup values ('Other->Jet Fuel','Other');
insert into substance_lookup values ('Other->Kerosene','Kerosene');
insert into substance_lookup values ('Other->Low Sulphur','Other');
insert into substance_lookup values ('Other->Mineral Oil','Other');
insert into substance_lookup values ('Other->Premixed Boat Gas','Marine fuel');
insert into substance_lookup values ('Other->Racing Fuel','Racing fuel/leaded gasoline');
insert into substance_lookup values ('Other->Solvent','Solvent');
insert into substance_lookup values ('Other->Soy Diesel','Diesel fuel (b-unknown)');
insert into substance_lookup values ('Other->STODDARD SOLVENT','Solvent');
insert into substance_lookup values ('Other->unknown','Unknown');
insert into substance_lookup values ('Other->WATER, Regular Unleaded','Gasoline (unknown type)');
insert into substance_lookup values ('Premium Unleaded','Gasoline (unknown type)');
insert into substance_lookup values ('Premium Unleaded, Unknown','Gasoline (unknown type)');
insert into substance_lookup values ('Regular Unleaded','Gasoline (unknown type)');
insert into substance_lookup values ('Regular Unleaded, Unknown','Gasoline (unknown type)');
insert into substance_lookup values ('Unknown','Unknown');
insert into substance_lookup values ('Used Oil','Used oil/waste oil');








Fiberglass Reinforced Plastic Coated, Galvanic/Sacrificial Current Cathodic Protection	TankCorrosionProtectionSacrificialAnode	
Fiberglass Reinforced Plastic Coated, Galvanic/Sacrificial Current Cathodic Protection, Impressed Current Cathodic Protection	TankCorrosionProtectionSacrificialAnode	
Fiberglass Reinforced Plastic Coated, Impressed Current Cathodic Protection		TankCorrosionProtectionImpressedCurrent
Galvanic/Sacrificial Current Cathodic Protection	TankCorrosionProtectionSacrificialAnode	TankCorrosionProtectionImpressedCurrent
Galvanic/Sacrificial Current Cathodic Protection, Impressed Current Cathodic Protection	TankCorrosionProtectionSacrificialAnode	TankCorrosionProtectionImpressedCurrent
Galvanic/Sacrificial Current Cathodic Protection, Impressed Current Cathodic Protection, Painted(e.g., asphaltic)	TankCorrosionProtectionSacrificialAnode	TankCorrosionProtectionImpressedCurrent
Galvanic/Sacrificial Current Cathodic Protection, Impressed Current Cathodic Protection, Painted(e.g., asphaltic), STIP 3	TankCorrosionProtectionSacrificialAnode	TankCorrosionProtectionImpressedCurrent
Galvanic/Sacrificial Current Cathodic Protection, Impressed Current Cathodic Protection, STIP3	TankCorrosionProtectionSacrificialAnode	TankCorrosionProtectionImpressedCurrent
Galvanic/Sacrificial Current Cathodic Protection, Impressed Current Cathodic Protection, STIP3 Tank	TankCorrosionProtectionSacrificialAnode	TankCorrosionProtectionImpressedCurrent
Galvanic/Sacrificial Current Cathodic Protection, Impressed Current Cathodic Protection, URATHANE COAT	TankCorrosionProtectionSacrificialAnode	TankCorrosionProtectionImpressedCurrent
Galvanic/Sacrificial Current Cathodic Protection, Painted(e.g., asphaltic)	TankCorrosionProtectionSacrificialAnode	
Galvanic/Sacrificial Current Cathodic Protection, Painted(e.g., asphaltic), Split compartment	TankCorrosionProtectionSacrificialAnode	
Galvanic/Sacrificial Current Cathodic Protection, Painted(e.g., asphaltic), STIP3 Tank	TankCorrosionProtectionSacrificialAnode	
Galvanic/Sacrificial Current Cathodic Protection, STIP3	TankCorrosionProtectionSacrificialAnode	
Galvanic/Sacrificial Current Cathodic Protection, STIP3 Tank	TankCorrosionProtectionSacrificialAnode	
Galvanic/Sacrificial Current Cathodic Protection, STIP3, STIP3 Tank	TankCorrosionProtectionSacrificialAnode	
IMPRESSED CURRENT 97, Impressed Current Cathodic Protection, Painted(e.g., asphaltic)		TankCorrosionProtectionImpressedCurrent
Impressed Current Cathodic Protection		TankCorrosionProtectionImpressedCurrent
Impressed Current Cathodic Protection, Impressed current installed August 2011, Painted(e.g., asphaltic)		TankCorrosionProtectionImpressedCurrent
Impressed Current Cathodic Protection, Impressed Current installed August 2011, Painted(e.g., asphaltic)		TankCorrosionProtectionImpressedCurrent
Impressed Current Cathodic Protection, Painted(e.g., asphaltic)		TankCorrosionProtectionImpressedCurrent
Impressed Current Cathodic Protection, Painted(e.g., asphaltic), STIP3 Tank		TankCorrosionProtectionImpressedCurrent
Impressed Current Cathodic Protection, STIP3 Tank		TankCorrosionProtectionImpressedCurrent
IMPRESSED CURRENT, Impressed Current Cathodic Protection		TankCorrosionProtectionImpressedCurrent







select t."Facility ID" as "FacilityID", t."Facility Name" as "FacilityName", t."Facility Address" as "FacilityAddress1",
	t."Facility City" as "FacilityCity", t."Facility County" as "FacilityCounty", t."Facility Zip" as "FacilityZipCode", 
	'NE' as "FacilityState", 7 as "FacilityEPARegion", 
	t."Owner Name" as "FacilityOwnerLastName", --did we decide how to handle company names???
    t."Owner Address" as "FacilityOwnerAddress1", t."Owner City" as FacilityOwnerCity, t."Owner State" as "FacilityOwnerState",
	t."Owner Zip" as "FacilityOwnerZipCode",
	t."Tank #" as "TankID", 
	case when t."Tank Type" = 'Federally Regulated' then 'Yes' end as "FederallyRegulated",
	case when t."Tank Usage Status" = 'Currently in Use' then 'Currently in use' 
		 when t."Tank Usage Status" = 'Temporarily Out of Use' then 'Temporarily out of service' 
	     when t."Tank Usage Status" = 'Permanently Out of Use' and f."Tanks Removed" > 0 then 'Closed (removed from ground)' 
		 when t."Tank Usage Status" = 'Permanently Out of Use' and f."Closed In Place" > 0 then 'Closed (in place)' 
		 when t."Tank Usage Status" = 'Permanently Out of Use' then 'Closed (status unknown)' end as "TankStatus",
	t."Tank Installed" as "InstallationDate",
	sl.epa_substance as "TankSubstanceStored",
	t."Tank Size" as "TankCapacityGallons", --assume gallons?
	case when lower(t."Tank Sec Contain") like '%excavation%' then 'Yes' end as "ExcavationLiner",
	case when lower(t."Tank Int Prot") like '%double%' or lower(t."Tank Ext Prot") like '%double%' or lower(t."Tank Sec Contain") like '%double%' then 'Double' end as "TankWallType", 
	case when t."Tank Constr." = 'Composite' then 'Composite/Clad (Steel w/Fiberglass Reinforced Plastic)'
	     when t."Tank Constr." = 'Fiberglass Reinforced Plastic' then 'Fiberglass Reinforced Plastic'
	     when t."Tank Constr." = 'Jacketed' then 'Jacketed Steel'
	     when t."Tank Constr." = 'NEW INSTALL' then 'Unknown'
	     when t."Tank Constr." = 'Stainless Steel' then 'Steel (NEC)'
	     when t."Tank Constr." = 'Steel' then 'Steel (NEC)'
	     when t."Tank Constr." = 'Unknown' then 'Unknown' end as "MaterialDescription",
	case when lower(t."Piping Const. Material") like '%fiberglass reinforced%' then 'Fiberglass Reinforced Plastic' 	 
		 when lower(t."Piping Const. Material") like '%copper%' then 'Copper' 
		 when lower(t."Piping Const. Material") like '%stainless steel%' then 'Stainless Steel' 
		 when lower(t."Piping Const. Material") like '%galvanized%' then 'Galvanized Steel' 
		 when lower(t."Piping Const. Material") like '%steel%' then 'Steel' 
		 when lower(t."Piping Const. Material") like '%flex%' or (t."Piping Const. Material") like '%APT%' then 'Flex Piping' 
		 when lower(t."Piping Const. Material") like '%unknown%' then 'Unknown' 
		 when t."Piping Const. Material" is not null then 'Other' end as "PipingMaterialDescription",
	case when lower(t."Piping Const. Material") like '%double%'	then 'Double Walled' end as "PipingWallType", 
    case when lower(t."Tank Ext Prot") like '%sacrificial%' then 'Yes' end as "TankCorrosionProtectionSacrificialAnode",
	case when lower(t."Tank Ext Prot") like '%sacrificial%' then 'Unknown' end as "TankCorrosionProtectionSacrificialAnodeInstalledOrRetrofitted",
    case when lower(t."Tank Ext Prot") like '%impressed%' then 'Yes' end as "TankCorrosionProtectionImpressedCurrent",
	case when lower(t."Tank Ext Prot") like '%sacrificial%' then 'Unknown' end as "TankCorrosionProtectionImpressedCurrentInstalledOrRetrofitted"
from tanks t left join facilities f on t."Facility ID" = f."Facility ID"
	left join substance_lookup sl on t."Tank Contents" = sl.tank_contents
order by t."Facility ID", t."Tank #";


select distinct "Piping Const. Material" from tanks order by 1;

